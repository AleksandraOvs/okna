!function(l){window.onLoadPPReCaptcha=function(){var n,e=l(".pp-grecaptcha");0<e.length&&e.each(function(e){var t=l(this),a=t.attr("data-widgetid"),i=l(this).attr("id");typeof a!=typeof undefined&&!1!==a||(t.attr("id",i),n=grecaptcha.render(i,{sitekey:t.data("sitekey"),theme:t.data("theme"),size:t.data("validate"),callback:function(e){""!=e&&(t.attr("data-pp-grecaptcha-response",e),"invisible"==t.data("validate")&&t.closest(".elementor-widget").find(".pp-submit-button").trigger("click"))}}),t.attr("data-widgetid",n))})};PPLoginForm=function(e,t,a){this.node=e,this.id=a.id,this.messages=a.messages,this.settings=a,this.elementSettings=t,this.i18n=a.i18n,this.form=l(this.node).find(".pp-login-form"),this.passwordField=this.form.find(".pp-lf-field-pw-toggle"),this._init()},PPLoginForm.prototype={settings:{},_init:function(){0<this.passwordField.find(".pp-lf-toggle-pw").length&&this.passwordField.find(".pp-lf-toggle-pw").on("click",l.proxy(this._passwordToggle,this)),this.settings.facebook_login&&this._initFacebookLogin(),0<this.node.find("#pp-form-"+this.id).length&&"yes"===this.elementSettings.enable_ajax&&this.node.find("#pp-form-"+this.id).on("submit",l.proxy(this._loginFormSubmit,this)),0<this.node.find(".pp-login-form--lost-pass").length&&this.node.find(".pp-login-form--lost-pass").on("submit",l.proxy(this._lostPassFormSubmit,this)),0<this.node.find(".pp-login-form--reset-pass").length&&this.node.find(".pp-login-form--reset-pass").on("submit",l.proxy(this._resetPassFormSubmit,this)),this.settings.enable_recaptcha&&this._initReCaptcha()},_passwordToggle:function(){var e=this.passwordField;pwFieldControl=e.find('.elementor-field[name="pwd"]'),"text"===pwFieldControl.attr("type")?(pwFieldControl.attr("type","password"),e.find(".pp-lf-toggle-pw").attr("aria-label",this.i18n.pw_toggle_text.show).find("span").removeClass("fa-eye-slash").addClass("fa-eye")):(pwFieldControl.attr("type","text"),e.find(".pp-lf-toggle-pw").attr("aria-label",this.i18n.pw_toggle_text.hide).find("span").removeClass("fa-eye").addClass("fa-eye-slash"))},_initReCaptcha:function(){var e=this.node.find(".pp-grecaptcha");elementorFrontend.isEditMode()&&undefined==e.attr("data-widgetid")&&onLoadPPReCaptcha()},_initFacebookLogin:function(){""!==this.settings.facebook_app_id&&0<this.node.find(".pp-fb-login-button").length&&(this._initFacebookSDK(),this.node.find(".pp-fb-login-button").on("click",l.proxy(this._facebookLoginClick,this)))},_initFacebookSDK:function(){var e=this;0===l("#fb-root").length&&l("body").prepend('<div id="fb-root"></div>');var t=document,a="script",i="facebook-jssdk",n=t.getElementsByTagName(a)[0];t.getElementById(i)||((t=t.createElement(a)).id=i,t.src="//connect.facebook.net/en_US/sdk.js",n.parentNode.insertBefore(t,n),window.fbAsyncInit=function(){FB.init({appId:e.settings.facebook_app_id,cookie:!0,xfbml:!0,version:"v2.12"})})},_facebookLoginClick:function(){var a=this,e=this.node.find(".pp-login-form").find('input[name="redirect_to"]'),i={action:"pp_lf_process_social_login",provider:"facebook",page_url:a.settings.page_url,nonce:a._getNonce()};0<e.length&&""!==e.val()&&(i.redirect=e.val()),this._disableForm(),FB.login(function(e){"connected"===e.status?FB.api("/me",{fields:"id, email, name, first_name, last_name"},function(e){var t=FB.getAuthResponse();i.user_data=e,i.auth_response=t,a._ajax(i,function(e){e.success?e.data.redirect_url?window.location.href=e.data.redirect_url:window.location.reload():(console.error(e.data),a._enableForm())})}):(e.authResponse&&console.error("PP Login Form: Unable to connect Facebook account."),a._enableForm())},{scope:"email",return_scopes:!0})},_loginFormSubmit:function(e){e.preventDefault();var a=l(e.target),t=a.find('input[name="log"]'),i=a.find('input[name="pwd"]'),n=a.find('input[name="rememberme"]'),s=a.find('input[name="redirect_to"]'),o=a.find(".pp-grecaptcha"),r=o.data("pp-grecaptcha-response"),p=this;if(t.parent().find(".pp-lf-error").remove(),i.parent().find(".pp-lf-error").remove(),o.parent().find(".pp-lf-error").remove(),""!==t.val().trim())if(""!==i.val()){if(0<o.length&&(void 0===r||!1===r)){if("normal"==o.data("validate"))return void l('<span class="pp-lf-error">').insertAfter(o).html(this.messages.empty_recaptcha);"invisible"==o.data("validate")&&grecaptcha.execute(o.data("widgetid"))}e=new FormData(a[0]);e.append("action","ppe_lf_process_login"),e.append("page_url",this.settings.page_url),e.append("username",t.val()),e.append("password",i.val()),0<s.length&&""!==s.val()&&e.append("redirect",s.val()),0<n.length&&n.is(":checked")&&e.append("remember","1"),0<o.length&&(e.append("recaptcha",!0),e.append("recaptcha_validate",o.data("validate")),e.append("recaptcha_validate_type",o.data("validate-type"))),r&&e.append("recaptcha_response",r),this._disableForm(),this._ajax(e,function(e){var t;e.success?e.data.redirect_url?(t=location.protocol+"//"+location.host,(""===e.data.redirect_url.split(t)[0]?e.data.redirect_url.split(t)[1]:e.data.redirect_url.split(t)[0])===location.href.split(t)[1]?window.location.reload():window.location.href=e.data.redirect_url):window.location.reload():(p._enableForm(),a.find(".pp-lf-error").remove(),l('<span class="pp-lf-error">').appendTo(a).html(e.data))})}else l('<span class="pp-lf-error">').insertAfter(i).html(this.messages.empty_password);else l('<span class="pp-lf-error">').insertAfter(t).html(this.messages.empty_username)},_lostPassFormSubmit:function(e){e.preventDefault();var a=l(e.target),i=a.find('input[name="user_login"]'),t=a.find('input[name="lost_redirect_to"]'),n=a.find('input[name="is_lost_redirect"]'),s=this;i.parent().find(".pp-lf-error").remove(),""!==i.val().trim()?((e=new FormData(a[0])).append("action","pp_lf_process_lost_pass"),e.append("page_url",this.settings.page_url),0<t.length&&""!==t.val()&&e.append("redirect",t.val()),this._disableForm(),this._ajax(e,function(e){var t;s._enableForm(),e.success?"0"===n.val()?(l('<p class="pp-lf-success">').insertAfter(a).html(s.messages.email_sent),a.hide()):e.data.redirect_url?(t=location.protocol+"//"+location.host,(""===e.data.redirect_url.split(t)[0]?e.data.redirect_url.split(t)[1]:e.data.redirect_url.split(t)[0])===location.href.split(t)[1]?window.location.reload():(window.location.href=e.data.redirect_url,l('<p class="pp-lf-success">').insertAfter(a).html(s.messages.email_sent),a.hide())):window.location.reload():(i.parent().find(".pp-lf-error").remove(),l('<span class="pp-lf-error">').insertAfter(i).html(e.data))})):l('<span class="pp-lf-error">').insertAfter(i).html(this.messages.empty_username)},_resetPassFormSubmit:function(e){e.preventDefault();var t=l(e.target),a=t.find('input[name="password_1"]'),i=t.find('input[name="password_2"]'),n=this;a.parent().find(".pp-lf-error").remove(),i.parent().find(".pp-lf-error").remove(),""!==a.val()?""!==i.val()?((e=new FormData(t[0])).append("action","pp_lf_process_reset_pass"),e.append("page_url",this.settings.page_url),this._disableForm(),this._ajax(e,function(e){n._enableForm(),e.success?(l('<p class="pp-lf-success">').insertAfter(t).html(n.messages.reset_success),t.hide()):(t.find(".pp-lf-error").remove(),l('<span class="pp-lf-error">').appendTo(t).html(e.data))})):l('<span class="pp-lf-error">').insertAfter(i).html(this.messages.empty_password_2):l('<span class="pp-lf-error">').insertAfter(a).html(this.messages.empty_password_1)},_enableForm:function(){this.node.find(".pp-login-form-wrap").removeClass("pp-event-disabled")},_disableForm:function(){this.node.find(".pp-login-form-wrap").addClass("pp-event-disabled")},_getNonce:function(){return this.node.find('.pp-login-form input[name="ppe-lf-login-nonce"]').val()},_ajax:function(e,t){var a={type:"POST",url:ppLogin.ajax_url,data:e,dataType:"json",success:function(e){"function"==typeof t&&t(e)},error:function(e,t){console.log(t)}};"undefined"==typeof e.provider&&(a.processData=!1,a.contentType=!1),l.ajax(a)}},PPGoogleLoginEndpoint=function(e,t){console.log(PPLoginForm.gtheme)}}(jQuery);